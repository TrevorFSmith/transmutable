{% extends "banana/base.html" %}
{% load imagetags %}

{% block sub-title %}{{ user.get_full_name }} | {% endblock %}

{% block style %}
#work-doc, #completed-list {
	min-height: 400px; 	
}
#completed-list {
	-moz-border-radius: 2em 0 2em 0;
	border-radius: 2em 0 2em 0;
	padding: 0;
}
#completed-list > li {
	border: solid 2px #EEE;
	-moz-border-radius: 2em 0 2em 0;
	border-radius: 2em 0 2em 0;
	padding: 1em 1em 0.5em 1em;
}

#work-doc {
	width: 580px;
	border: solid 2px #EEE;
	-moz-border-radius: 2em 0 2em 0;
	border-radius: 2em 0 2em 0;
	padding: 1em 1em 0.5em 1em;
}
.editable-section { 
	position: relative;
}
.editable-section:hover { background-color: #EEE; }
#work-doc-controls, #completed-controls { visibility: hidden; float: right; padding: 0px; }
.editable-section:hover #work-doc-controls, #completed-list:hover #completed-controls, #notes-list:hover form { visibility: visible; }

#right-column {
	width: 380px;
	float: right;
}

#top-right-column {
	float: right;
	width: 380px;
	height: 170px;
}
#top-right-column h3 a { text-decoration: none; }
#top-right-column:hover h3 a { text-decoration: underline; }
#notes-list {
	border: solid 2px #EEE;
	-moz-border-radius: 2em 0 2em 0;
	border-radius: 2em 0 2em 0;
	padding: 1em 1em 0.5em 1em;
	height: 120px;
}
#notes-list li { display: inline; margin-right: 10px; }
#notes-list form { text-align: left; visibility: hidden; }
#user-info { min-height: 170px; width: 600px; }
#completed-list:hover > li { background-color: #FFF; }
{% endblock %}

{% block sub-head %}
<script>
$(document).ready(function() {
	$('button[name="edit-work-doc-button"]').click(function(){ document.location.href = "{% url banana.views.user_edit %}"; })
	$('button[name="edit-completed-button"]').click(function(){ document.location.href = "{% url banana.views.user_edit %}"; })
});
</script>
{% endblock %}

{% block content %}

<div id="top-right-column">
	<h3><a href="{% url peach.views.index %}">Notes</a>:</h3>
	<div id="notes-list" class="{% if request.user.username == user.username %}editable-section{% endif %}">
		<ul>
			{% for namespace in user.namespaces.all %}
			<li><a href="{{ namespace.get_absolute_url }}">{{ namespace.display_name }}</a></li>
			{% endfor %}
		</ul>
		{% if request.user.is_authenticated and request.user.username == user.username %}
			<form action="{% url peach.views.index %}" method="post" id="create-namespace-form">{% for field in namespace_form %}{{ field }}{% endfor %}</form>
		{% endif %}
	</div>
</div>

<div id="user-info">
	{% if user.get_profile.photo %}
	<img class="person-photo" src="{{ user.get_profile.photo.image.url|thumbnail:"150w" }}" width="150" title="{{ user.get_full_name}}" alt="{{ user.get_full_name}}" />
	{% else %}
	<img class="person-photo" src="{{ MEDIA_URL }}person/BlankIcon150x150.jpg" width="150" height="150" />		
	{% endif %}
	<h1>{{ user.get_full_name }}</h1>
</div>
<div id="right-column">
	<h3>What I did:</h3>
	<ul id="completed-list" class="{% if request.user.username == user.username %} editable-section{% endif %}">
	{% if request.user.username == user.username %}<div id="completed-controls"><button name="edit-completed-button" class="positive">edit</button></div>{% endif %}
	{% for completed_item in user.completed_items.all|slice:":10" %}
		{% include "banana/completed_item.frag" %}
	{% endfor %}
	</ul>
</div>
<h3>What I'm doing:</h3>
<div id="work-doc" class="rendered-wrapper{% if request.user.username == user.username %} editable-section{% endif %}">
	{% if request.user.username == user.username %}<div id="work-doc-controls"><button name="edit-work-doc-button" class="positive">edit</button></div>{% endif %}
	{{ user.work_doc.rendered|safe }}
</div>
{% endblock %}